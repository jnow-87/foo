#
# kernel basics
#
# {{{
config KERNEL_SMP
	bool "Build an SMP system"
	default n

menu "Hidden"
	visible if 0

	config KERNEL_NO_VIRT_MEM
		bool "Kernel virtual memory support"
		default n

	config KERNEL_VIRT_MEM
		bool "Kernel virtual memory support"
		default n	if KERNEL_NO_VIRT_MEM
		default y
endmenu
# }}}

#
# kernel memory layout
#
# {{{
menu "Memory configuration"
config KERNEL_IMAGE_BASE
	hex "Kernel image base address"
	default 0x0

config KERNEL_IMAGE_SIZE
	int "Kernel image size"
	default 0

config KERNEL_INITRAMFS_BASE
	hex "Init ram file system base address"
	default 0x0

config KERNEL_INITRAMFS_SIZE
	int "Init ram file system size"
	default 0

config KERNEL_HEAP_BASE
	hex "Kernel heap base address"
	default 0x0

config KERNEL_HEAP_SIZE
	int "Kernel heap size"
	default 0

config KERNEL_PROC_BASE
	hex "Process heap base address"
	default 0x0

config KERNEL_PROC_SIZE
	int "Process heap size"
	default 0

config KERNEL_STACK_BASE
	hex "Kernel stack base address"
	default 0x0

if KERNEL_VIRT_MEM
	choice
		prompt "Kernel/Thread stack size"

		config KERNEL_STACK_SIZE_4k
			bool "4k"

		config KERNEL_STACK_SIZE_16k
			bool "16k"

		config KERNEL_STACK_SIZE_64k
			bool "64k"

		config KERNEL_STACK_SIZE_256k
			bool "256k"

		config KERNEL_STACK_SIZE_1M
			bool "1M"

		config KERNEL_STACK_SIZE_4M
			bool "4M"

		config KERNEL_STACK_SIZE_16M
			bool "16M"

		config KERNEL_STACK_SIZE_64M
			bool "64M"

		config KERNEL_STACK_SIZE_256M
			bool "256M"

		config KERNEL_STACK_SIZE_1G
			bool "1G"
	endchoice
	
	menu "Hidden"
		visible if 0

		config KERNEL_STACK_SIZE
			int "Thread stack size"
			default 0	if KERNEL_STACK_SIZE_4k
			default 1	if KERNEL_STACK_SIZE_16k
			default 2	if KERNEL_STACK_SIZE_64k
			default 3	if KERNEL_STACK_SIZE_256k
			default 4	if KERNEL_STACK_SIZE_1M
			default 5	if KERNEL_STACK_SIZE_4M
			default 6	if KERNEL_STACK_SIZE_16M
			default 7	if KERNEL_STACK_SIZE_64M
			default 8	if KERNEL_STACK_SIZE_256M
			default 9	if KERNEL_STACK_SIZE_1G
	endmenu
endif # KERNEL_VIRT_MEM

if KERNEL_NO_VIRT_MEM
	config KERNEL_STACK_SIZE
		int "Thread stack size"
		default 4096
endif # KERNEL_NO_VIRT_MEM

config KMALLOC_ALIGN
	int "Alignment to be used for kernel level memory allocators (has to be a power of 2)"
	default 4
endmenu
# }}}

#
# system calls
#
# {{{
menu "System calls"
	config SC_FILESYSTEM
		bool "File system"
		default y
		help
			This includes open, close, read, write, ioctl, fcntl, rmnode and chdir

	config SC_DYNMEM
		bool "Dynamic memory"
		default y
		help
			This includes malloc and free

	config SC_SCHED
		bool "Scheduler"
		default y
		help
			This includes sched_yield

	config SC_TIME
		bool "Time"
		default y
		help
			This includes sleep and time

	config SC_PROCESS
		bool "Process control"
		default y
		help
			This includes process_create and process_info

	config SC_THREAD
		bool "Thread control"
		default y
		help
			This includes thread_create, thread_info and nice
endmenu
# }}}

#
# init binary
#
# {{{
menu "Init binary settings"
	config INIT_BINARY
		hex "Adress of the init binary"

	choice
		prompt "Init binary type"

		config INIT_BINTYPE_RAW
			bool "INIT_BINARY points to the init entry address"

		config INIT_BINARY_ELF
			bool "INIT_BINARY points to an ELF file"
	endchoice

	config INIT_ARGS
		qstring "Init argument string"
		default ""

	menu "Hidden"
		visible if 0

		config INIT_BINTYPE
			int "Init binary type"
			default 0	if INIT_BINTYPE_RAW
			default 1	if INIT_BINARY_ELF
	endmenu
endmenu
# }}}

#
# scheduler
#
# {{{
menu "Scheduler settigns"
	config SCHED_CYCLETIME_US
		int "Scheduler cycle time [us]"

	config SCHED_ERR_MAX
		int "Maximal scheduler error [%]"

	config SCHED_PRIO_DEFAULT
		int "Default process priority"
		default 0

	config SCHED_AFFINITY_DEFAULT
		hex "Default process affinity"
		default 0x1
endmenu
# }}}

#
# timer
#
# {{{
menu "Timer settings"
	config KTIMER_CYCLETIME_US
		int "Kernel timer cycle time [us]"

	config KTIMER_ERR_MAX
		int "Maximal kernel timer error [%]"
endmenu
# }}}

#
# file system
#
# {{{
menu "File system"
	source "kernel/fs/Kconfig"
endmenu

#
# uart parameter
#
# {{{
menuconfig KERNEL_UART
	bool "Kernel uart"
	select DRIVER_UART

if KERNEL_UART

menu "kprintf"
	config KERNEL_EARLY_PRINT
		bool "Print error on failed kernel init calls"

	config KERNEL_MSG_FATAL
		bool "Print kernel FATAL messages"

	config KERNEL_MSG_WARN
		bool "Print kernel WARNING messages"

	config KERNEL_MSG_INFO
		bool "Print kernel INFO messages"

	config KERNEL_MSG_DEBUG
		bool "Print kernel DEBUG messages"

	config KERNEL_SC_DEBUG
		bool "Enable syscall debug messages"
		depends on KERNEL_MSG_DEBUG

	config KERNEL_FS_DEBUG
		bool "Enable file system debug messages"
		depends on KERNEL_MSG_DEBUG

	config DRIVER_DEBUG
		bool "Enable driver debug messages"
		depends on KERNEL_MSG_DEBUG
endmenu

# baud rate
choice
	prompt "Uart baud rate"

	config KERNEL_UART_BR_2400
		bool "Uart baud rate 2400"

	config KERNEL_UART_BR_4800
		bool "Uart baud rate 4800"

	config KERNEL_UART_BR_9600
		bool "Uart baud rate 9600"

	config KERNEL_UART_BR_14400
		bool "Uart baud rate 14400"

	config KERNEL_UART_BR_19200
		bool "Uart baud rate 19200"

	config KERNEL_UART_BR_28800
		bool "Uart baud rate 28800"

	config KERNEL_UART_BR_38400
		bool "Uart baud rate 38400"

	config KERNEL_UART_BR_57600
		bool "Uart baud rate 57600"

	config KERNEL_UART_BR_76800
		bool "Uart baud rate 76800"

	config KERNEL_UART_BR_115200
		bool "Uart baud rate 115200"

	config KERNEL_UART_BR_230400
		bool "Uart baud rate 230400"

	config KERNEL_UART_BR_250000
		bool "Uart baud rate 250000"

		config KERNEL_UART_BR_500000
		bool "Uart baud rate 500000"

	config KERNEL_UART_BR_1000000
		bool "Uart baud rate 1000000"
endchoice

menu "Hidden"
	visible if 0

	config KERNEL_UART_BAUDRATE
		int "Uart baud rate"
		default 2400	if KERNEL_UART_BR_2400
		default 4800	if KERNEL_UART_BR_4800
		default 9600	if KERNEL_UART_BR_9600
		default 14400	if KERNEL_UART_BR_14400
		default 19200	if KERNEL_UART_BR_19200
		default 28800	if KERNEL_UART_BR_28800
		default 38400	if KERNEL_UART_BR_38400
		default 57600	if KERNEL_UART_BR_57600
		default 76800	if KERNEL_UART_BR_76800
		default 115200	if KERNEL_UART_BR_115200
		default 230400	if KERNEL_UART_BR_230400
		default 250000	if KERNEL_UART_BR_250000
		default 500000	if KERNEL_UART_BR_500000
		default 1000000	if KERNEL_UART_BR_1000000
endmenu

# parity
choice
	prompt "Parity"
	default KERNEL_UART_PARITY_NONE

	config KERNEL_UART_PARITY_ODD
		bool "Odd"

	config KERNEL_UART_PARITY_EVEN
		bool "Even"

	config KERNEL_UART_PARITY_NONE
		bool "None"
endchoice

menu "Hidden"
	visible if 0

	config KERNEL_UART_PARITY
		int "Stop bits"
		default 0	if KERNEL_UART_PARITY_NONE
		default 1	if KERNEL_UART_PARITY_ODD
		default 2	if KERNEL_UART_PARITY_EVEN
endmenu

# stop bits
choice
	prompt "Stop bits"
	default KERNEL_UART_STOPB_1

	config KERNEL_UART_STOPB_1
		bool "1"

	config KERNEL_UART_STOPB_2
		bool "2"
endchoice

menu "Hidden"
	visible if 0

	config KERNEL_UART_STOPBITS
		int "Stop bits"
		default 1	if KERNEL_UART_STOPB_1
		default 2	if KERNEL_UART_STOPB_2
endmenu
endif # KERNEL_UART
# }}}

#
# kernel test
#
# {{{
config KERNEL_TEST
	bool "Execute 'kernel_test()' on boot"
# }}}

#
# kernel stat
#
# {{{
config KERNEL_STAT
	bool "Execute 'kernel_stat()' on boot"
# }}}
